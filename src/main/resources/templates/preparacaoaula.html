<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Preparação de Aula</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Estilos Gerais */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 0;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 40px auto;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        /* Topo da Página */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.2em;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header h1 .edit-icon {
            font-size: 0.7em;
            color: #7f8c8d;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .header h1 .edit-icon:hover {
            color: #3498db;
        }

        .breadcrumb {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-bottom: 15px;
        }

        .breadcrumb a {
            color: #3498db;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.2s ease, color 0.2s ease;
            border: none;
            cursor: pointer;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }

        /* Detalhes da Aula */
        .lesson-details {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .lesson-details label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .lesson-details input[type="text"],
        .lesson-details textarea {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 1em;
        }

        .lesson-details textarea {
            min-height: 120px;
            resize: vertical;
        }

        .lesson-details .actions {
            text-align: right;
            margin-top: 20px;
            display: flex; /* Use flex for button alignment */
            justify-content: flex-end;
            gap: 10px;
        }

        /* Seção de Arquivos */
        .arquivos-section {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 25px;
            border-radius: 8px;
            position: relative; /* For the floating add button */
        }

        .arquivos-section h3 {
            color: #2c3e50;
            font-size: 1.6em;
            margin-top: 0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #eee;
        }

        .btn-add-arquivo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 2em;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: absolute; /* Alterado de 'fixed' para 'absolute' */
            bottom: 15px; /* Ajuste a distância da parte inferior do contêiner */
            right: 15px; /* Ajuste a distância da parte direita do contêiner */
            z-index: 100;
        }

        .arquivo-list {
            list-style: none;
            padding: 0;
            margin-top: 20px;
            min-height: 150px; /* Ensure space even if no arquivos */
        }

        .arquivo-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #ffffff;
            border: 1px solid #dee2e6;
            padding: 15px 20px;
            margin-bottom: 10px;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
        }

        .arquivo-item:hover {
            border-color: #a7d9ff;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .arquivo-info {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }

        .arquivo-info .icon {
            font-size: 1.8em;
            margin-right: 15px;
            color: #3498db;
            width: 30px; /* Fixed width for icons */
            text-align: center;
        }

        .arquivo-info .details {
            flex-grow: 1;
        }

        .arquivo-info .details h4 {
            margin: 0;
            font-size: 1.1em;
            color: #2c3e50;
        }

        .arquivo-info .details p {
            margin: 5px 0 0;
            font-size: 0.85em;
            color: #7f8c8d;
        }

        .arquivo-actions a {
            color: #6c757d;
            margin-left: 15px;
            font-size: 1.1em;
            transition: color 0.2s ease;
        }

        .arquivo-actions a:hover {
            color: #007bff;
        }

        .arquivo-actions .delete-btn {
            color: #dc3545;
        }

        .arquivo-actions .delete-btn:hover {
            color: #c82333;
        }

        .no-arquivos {
            text-align: center;
            padding: 30px;
            color: #7f8c8d;
            font-style: italic;
            border: 1px dashed #e9ecef;
            border-radius: 8px;
            margin-top: 20px;
        }

        /* Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top, higher than other elements */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.6); /* Black w/ more opacity */
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
            width: 80%;
            max-width: 600px; /* Slightly larger for modals */
            position: relative;
        }

        .close-button {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 20px;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .modal-content h3 {
            margin-top: 0;
            color: #2c3e50;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        /* Drop Zone Styles */
        .drop-zone {
            border: 2px dashed #ced4da;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            color: #6c757d;
            font-size: 1.1em;
            cursor: pointer;
            transition: border-color 0.3s ease, background-color 0.3s ease;
            margin-bottom: 15px;
        }

        .drop-zone.highlight {
            border-color: #007bff;
            background-color: #e7f3ff;
        }

        .drop-zone p {
            margin: 0;
            padding: 10px 0;
        }

        .drop-zone .icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1 th:if="${aula.id == null}">
            Nova Aula para <span th:text="${nomeCurso}">Nome do Curso</span>
        </h1>
        <h1 th:unless="${aula.id == null}">
            Preparar Aula: <span th:text="${aula.titulo}">Título da Aula</span>
            <i class="fas fa-pencil-alt edit-icon" id="editAulaTitleDesc"></i>
        </h1>
        <a th:href="@{'/cursos'}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Voltar para o Curso
        </a>
    </div>

    <div th:if="${msg}" class="mensagem sucesso" th:text="${msg}"></div>
    <div th:if="${erro}" class="mensagem erro" th:text="${erro}"></div>

    <div class="lesson-details">
        <form id="aulaDetailsForm" th:action="@{/aula/salvar}" method="post">
            <input type="hidden" name="id" th:value="${aula.id}">
            <input type="hidden" name="idCurso" th:value="${aula.idCurso}">

            <div class="form-group">
                <label for="tituloAula">Título da Aula:</label>
                <input type="text" id="tituloAula" name="titulo" th:value="${aula.titulo}" required
                       th:attr="readonly=${aula.id == null ? false : true}">
            </div>

            <div class="form-group">
                <label for="descricaoAula">Descrição da Aula:</label>
                <textarea id="descricaoAula" name="descricao" rows="5" placeholder="Descreva os objetivos, tópicos abordados e pré-requisitos desta aula..." required
                          th:attr="readonly=${aula.id == null ? false : true}" th:text="${aula.descricao}"></textarea>
            </div>

            <div class="actions" id="aulaDetailsActions"
                 th:style="${aula.id == null ? 'display: flex;' : 'display: none;'}">
                <button type="submit" class="btn btn-success"><i class="fas fa-save"></i> Salvar Aula</button>
                <button type="button" class="btn btn-secondary" id="cancelEditAulaDetails" th:if="${aula.id != null}"><i class="fas fa-times"></i> Cancelar</button>
            </div>
        </form>
    </div>

    <div class="arquivos-section" th:if="${aula.id != null}">
        <h3><i class="fas fa-paperclip"></i> Materiais de Apoio</h3>

        <ul class="arquivo-list">
            <li th:if="${#lists.isEmpty(aula.arquivos)}" class="no-arquivos">Nenhum material adicionado ainda. Clique no botão "+" para começar!</li>

            <li th:each="material : ${aula.arquivos}" class="arquivo-item" th:data-material-id="${material.id}">
                <div class="arquivo-info">
                    <i class="icon" th:classappend="${material.tipo == 'ARQUIVO' ? 'fas fa-file-alt' : (material.tipo == 'VIDEO' ? 'fab fa-youtube' : (material.tipo == 'LINK' ? 'fas fa-link' : (material.tipo == 'TEXTO_RICO' ? 'fas fa-align-left' : 'fas fa-question-circle')))}"></i>
                    <div class="details">
                        <h4 th:text="${material.nome}">Título do Material</h4>
                        <p th:text="${material.tipo}">Tipo do material.</p>
                    </div>
                </div>
                <div class="arquivo-actions">
                    <a th:if="${material.tipo == 'ARQUIVO'}" th:href="@{'/material/download/' + ${material.id}}" target="_blank" title="Baixar"><i class="fas fa-download"></i></a>
                    <a th:if="${material.tipo == 'VIDEO' or material.tipo == 'LINK'}" th:href="${material.caminho}" target="_blank" title="Abrir"><i class="fas fa-external-link-alt"></i></a>
                    <a th:if="${material.tipo == 'TEXTO_RICO'}" href="#" th:onclick="'openRichTextModal(\'' + ${material.id} + '\')'" title="Visualizar Conteúdo"><i class="fas fa-eye"></i></a>

                    <a href="#" class="edit-material-btn" th:data-material-id="${material.id}" title="Editar"><i class="fas fa-pencil-alt"></i></a>
                    <a href="#" class="delete-material-btn" th:data-material-id="${material.id}" title="Excluir"><i class="fas fa-trash-alt delete-btn"></i></a>
                </div>
            </li>
        </ul>
        <button class="btn btn-primary btn-add-arquivo" id="addMaterialBtn">
            <i class="fas fa-plus"></i>
        </button>
    </div>
</div>

<div id="addFileModal" class="modal">
    <div class="modal-content">
        <span class="close-button">×</span>
        <h3>Adicionar Arquivo à Aula</h3>
        <form id="addFileForm" th:action="@{/upload}" method="post" enctype="multipart/form-data">
            <input type="hidden" name="aulaId" th:value="${aula.id}">

            <div style="margin-bottom: 15px;">
                <label for="fileTitle">Título do Material:</label>
                <input type="text" id="fileTitle" name="titulo" placeholder="Ex: Slides da Aula 1" required style="width: 100%; padding: 8px;">
            </div>

            <div class="drop-zone" id="fileDropZone">
                <i class="fas fa-cloud-upload-alt icon"></i>
                <p>Arraste e solte seu arquivo aqui ou</p>
                <label for="selectFileInput" class="btn btn-primary" style="display: inline-block; margin-top: 10px;">
                    <i class="fas fa-folder-open"></i> Selecionar Arquivo
                </label>
                <input type="file" id="selectFileInput" name="file" style="display: none;" required>
                <span id="fileNameDisplay" style="margin-left: 10px; display: block; margin-top: 10px; font-size: 0.9em; color: #555;">Nenhum arquivo selecionado</span>
            </div>

            <div class="modal-actions" style="text-align: right; margin-top: 20px;">
                <button type="submit" class="btn btn-success"><i class="fas fa-upload"></i> Fazer Upload</button>
                <button type="button" class="btn btn-secondary close-modal-btn"><i class="fas fa-times"></i> Cancelar</button>
            </div>
        </form>
    </div>
</div>

<div id="addVideoModal" class="modal">
    <div class="modal-content">
        <span class="close-button">×</span>
        <h3>Adicionar Vídeo à Aula</h3>
        <form id="addVideoForm" th:action="@{/material/salvar}" method="post">
            <input type="hidden" name="aulaId" th:value="${aula.id}">
            <input type="hidden" name="tipoMaterial" value="VIDEO">

            <label for="videoTitle">Título do Vídeo:</label>
            <input type="text" id="videoTitle" name="titulo" placeholder="Ex: Introdução ao Python" required>

            <label for="videoUrl">URL do Vídeo (YouTube, Vimeo, etc.):</label>
            <input type="url" id="videoUrl" name="url" placeholder="http://youtube.com/watch?v=..." required>

            <label for="videoDescription">Descrição (opcional):</label>
            <textarea id="videoDescription" name="descricao" rows="3" placeholder="Breve descrição do conteúdo do vídeo"></textarea>

            <div class="modal-actions">
                <button type="submit" class="btn btn-success"><i class="fas fa-plus-circle"></i> Adicionar Vídeo</button>
                <button type="button" class="btn btn-secondary close-modal-btn"><i class="fas fa-times"></i> Cancelar</button>
            </div>
        </form>
    </div>
</div>

<div id="addLinkModal" class="modal">
    <div class="modal-content">
        <span class="close-button">×</span>
        <h3>Adicionar Link Externo à Aula</h3>
        <form id="addLinkForm" th:action="@{/material/salvar}" method="post">
            <input type="hidden" name="aulaId" th:value="${aula.id}">
            <input type="hidden" name="tipoMaterial" value="LINK">

            <label for="linkTitle">Título do Link:</label>
            <input type="text" id="linkTitle" name="titulo" placeholder="Ex: Documentação Oficial Python" required>

            <label for="linkUrl">URL do Link:</label>
            <input type="url" id="linkUrl" name="url" placeholder="https://docs.python.org/3/" required>

            <label for="linkDescription">Descrição (opcional):</label>
            <textarea id="linkDescription" name="descricao" rows="3" placeholder="Breve descrição do recurso"></textarea>

            <div class="modal-actions">
                <button type="submit" class="btn btn-success"><i class="fas fa-plus-circle"></i> Adicionar Link</button>
                <button type="button" class="btn btn-secondary close-modal-btn"><i class="fas fa-times"></i> Cancelar</button>
            </div>
        </form>
    </div>
</div>

<div id="addRichTextModal" class="modal">
    <div class="modal-content">
        <span class="close-button">×</span>
        <h3>Adicionar Texto/Conteúdo à Aula</h3>
        <form id="addRichTextForm" th:action="@{/material/salvar}" method="post">
            <input type="hidden" name="aulaId" th:value="${aula.id}">
            <input type="hidden" name="tipoMaterial" value="TEXTO_RICO">

            <label for="richTextTitle">Título do Conteúdo:</label>
            <input type="text" id="richTextTitle" name="titulo" placeholder="Ex: Notas da Aula, Exemplo de Código" required>

            <label for="richTextContent">Conteúdo:</label>
            <textarea id="richTextContent" name="conteudo" rows="10" placeholder="Insira seu texto ou conteúdo HTML aqui."></textarea>

            <div class="modal-actions">
                <button type="submit" class="btn btn-success"><i class="fas fa-plus-circle"></i> Adicionar Conteúdo</button>
                <button type="button" class="btn btn-secondary close-modal-btn"><i class="fas fa-times"></i> Cancelar</button>
            </div>
        </form>
    </div>
</div>

<div id="viewRichTextModal" class="modal">
    <div class="modal-content">
        <span class="close-button">×</span>
        <h3 id="viewRichTextTitle"></h3>
        <div id="viewRichTextContent" style="max-height: 400px; overflow-y: auto; border: 1px solid #eee; padding: 15px; border-radius: 5px;">
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-secondary close-modal-btn"><i class="fas fa-check"></i> Fechar</button>
        </div>
    </div>
</div>

<script th:inline="javascript">
    /*<![CDATA[*/
    document.addEventListener('DOMContentLoaded', function() {

        const aulaId = /*[[${aula.id}]]*/ null;
        const cursoId = /*[[${cursoId}]]*/ null;

        // --- Funções para Modais ---
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            document.body.style.overflow = '';
        }

        // --- Lógica para o Botão Flutuante "+" (addMaterialBtn) ---
        const addMaterialBtn = document.getElementById('addMaterialBtn');
        if (addMaterialBtn) {
            addMaterialBtn.addEventListener('click', () => {
                openModal('addFileModal'); // Directly open the addFileModal
            });
        }

        // Removed logic for material type selection modal as it's no longer needed.
        // document.getElementById('addFileOptionBtn').addEventListener('click', () => { ... });
        // document.getElementById('addVideoOptionBtn').addEventListener('click', () => { ... });
        // document.getElementById('addLinkOptionBtn').addEventListener('click', () => { ... });
        // document.getElementById('addRichTextOptionBtn').addEventListener('click', () => { ... });

        // --- Lógica para o Modal de Adicionar Arquivo (Seleção e Drag-and-Drop) ---
        const fileDropZone = document.getElementById('fileDropZone');
        const selectFileInput = document.getElementById('selectFileInput');
        const fileNameDisplay = document.getElementById('fileNameDisplay');

        if (fileDropZone && selectFileInput && fileNameDisplay) {
            // Abre o seletor de arquivo ao clicar na zona de drop ou no botão "Selecionar Arquivo"
            fileDropZone.addEventListener('click', (event) => {
                // Previne que o clique no botão "Selecionar Arquivo" acione o evento duas vezes
                if (event.target.id !== 'selectFileInput') {
                    selectFileInput.click();
                }
            });

            // Atualiza o nome do arquivo selecionado
            selectFileInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    fileNameDisplay.textContent = `Arquivo selecionado: ${file.name}`;
                } else {
                    fileNameDisplay.textContent = 'Nenhum arquivo selecionado';
                }
            });

            // Drag-and-Drop: Prevenir comportamento padrão
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                fileDropZone.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false); // Previne para todo o body
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            // Drag-and-Drop: Adicionar/Remover destaque visual
            ['dragenter', 'dragover'].forEach(eventName => {
                fileDropZone.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                fileDropZone.addEventListener(eventName, unhighlight, false);
            });

            function highlight() {
                fileDropZone.classList.add('highlight');
            }

            function unhighlight() {
                fileDropZone.classList.remove('highlight');
            }

            // Drag-and-Drop: Lidar com o arquivo solto
            fileDropZone.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;

                if (files.length > 0) {
                    // Atribui o arquivo ao input de tipo "file"
                    selectFileInput.files = files;
                    // Atualiza o texto de exibição do nome do arquivo
                    fileNameDisplay.textContent = `Arquivo selecionado: ${files[0].name}`;
                }
            }
        }

        // --- Fechar modais (botões de fechar e clique fora) ---
        document.querySelectorAll('.close-button, .close-modal-btn').forEach(btn => {
            btn.addEventListener('click', (event) => {
                const modal = event.target.closest('.modal');
                if (modal) {
                    closeModal(modal.id);
                }
            });
        });

        window.addEventListener('click', (event) => {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
                document.body.style.overflow = '';
            }
        });

        // --- Lógica para Editar Título/Descrição da Aula ---
        const editAulaTitleDescBtn = document.getElementById('editAulaTitleDesc');
        const tituloAulaInput = document.getElementById('tituloAula');
        const descricaoAulaTextarea = document.getElementById('descricaoAula');
        const aulaDetailsActions = document.getElementById('aulaDetailsActions');
        const cancelEditAulaDetailsBtn = document.getElementById('cancelEditAulaDetails');
        let originalTitulo = tituloAulaInput ? tituloAulaInput.value : '';
        let originalDescricao = descricaoAulaTextarea ? descricaoAulaTextarea.value : '';

        if (editAulaTitleDescBtn) {
            editAulaTitleDescBtn.addEventListener('click', () => {
                tituloAulaInput.readOnly = false;
                descricaoAulaTextarea.readOnly = false;
                aulaDetailsActions.style.display = 'flex';
                originalTitulo = tituloAulaInput.value;
                originalDescricao = descricaoAulaTextarea.value;
                tituloAulaInput.focus();
            });
        }

        if (cancelEditAulaDetailsBtn) {
            cancelEditAulaDetailsBtn.addEventListener('click', () => {
                tituloAulaInput.value = originalTitulo;
                descricaoAulaTextarea.value = originalDescricao;
                tituloAulaInput.readOnly = true;
                descricaoAulaTextarea.readOnly = true;
                aulaDetailsActions.style.display = 'none';
            });
        }

        // --- Lógica para Deletar Material ---
        document.querySelectorAll('.delete-material-btn').forEach(btn => {
            btn.addEventListener('click', (event) => {
                event.preventDefault();
                const materialId = event.currentTarget.dataset.materialId;
                if (confirm('Tem certeza que deseja excluir este material?')) {
                    fetch('/material/excluir/' + materialId, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    })
                    .then(response => {
                        if (response.ok) {
                            event.currentTarget.closest('.arquivo-item').remove();
                            const materialList = document.querySelector('.arquivo-list');
                            if (!materialList.querySelector('.arquivo-item')) { // Verifica se não há mais itens
                                materialList.innerHTML = '<li class="no-arquivos">Nenhum material adicionado ainda. Clique no botão "+" para começar!</li>';
                            }
                        } else {
                            alert('Erro ao excluir o material.');
                        }
                    })
                    .catch(error => {
                        console.error('Erro:', error);
                        alert('Erro na comunicação com o servidor.');
                    });
                }
            });
        });

        // --- Lógica para Editar Material (placeholder) ---
        document.querySelectorAll('.edit-material-btn').forEach(btn => {
            btn.addEventListener('click', (event) => {
                event.preventDefault();
                const materialId = event.currentTarget.dataset.materialId;
                alert('Funcionalidade de edição para material ' + materialId + ' a ser implementada!');
            });
        });
        function openRichTextModal(materialId) {
            fetch('/material/conteudo/' + materialId)
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    }
                    throw new Error('Erro ao buscar conteúdo do material.');
                })
                .then(data => {
                    const viewModal = document.getElementById('viewRichTextModal');
                    const viewTitle = document.getElementById('viewRichTextTitle');
                    const viewContent = document.getElementById('viewRichTextContent');

                    viewTitle.textContent = data.titulo;
                    viewContent.innerHTML = data.conteudo;

                    openModal('viewRichTextModal');
                })
                .catch(error => {
                    console.error('Erro:', error);
                    alert('Não foi possível carregar o conteúdo do material.');
                });
        }
        window.openRichTextModal = openRichTextModal;
    });
    /*]]>*/
</script>
</body>
</html>